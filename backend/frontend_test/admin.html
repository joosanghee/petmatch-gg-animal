<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PetMatch - ê´€ë¦¬ì ëª¨ë“œ</title>
  <link rel="stylesheet" href="{{ url_for('serve_css') }}" />
  <style>
    .admin-container { display: flex; gap: 20px; flex-wrap: wrap; }
    .admin-section { flex: 1; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); min-width: 300px; }
    .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 2px solid var(--line); padding-bottom: 10px; }
    .data-list { max-height: 400px; overflow-y: auto; }
    .data-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #eee; font-size: 14px; }
    .data-item:hover { background: #f9f9f9; }
    .del-btn { background: #ff4d4d; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px; }
    .add-form { background: #f0f0f0; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
    .add-form input, .add-form select { margin-bottom: 8px; width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand"><a href="/" style="text-decoration:none; color:inherit;">ğŸ¾ PetMatch Admin</a></div>
    <nav class="nav">
      <a href="/">í™ˆìœ¼ë¡œ</a>
      <a class="btn ghost" href="/logout">ë¡œê·¸ì•„ì›ƒ</a>
    </nav>
  </header>

  <main class="container">
    <h1 style="margin: 20px 0;">ğŸ‘‘ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div style="padding:10px; margin-bottom:10px; border-radius:8px; background:{{ '#fee2e2' if category=='error' else '#dcfce7' }}; color:{{ '#991b1b' if category=='error' else '#166534' }};">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="admin-container">
      
      <section class="admin-section">
        <div class="admin-header"><h3>ğŸ• ìœ ê¸°ë™ë¬¼ ê´€ë¦¬</h3></div>
        
        <form class="add-form" action="/admin/add" method="POST">
          <input type="hidden" name="item_type" value="animal">
          
          <div style="margin-bottom:8px; font-weight:bold; color:var(--accent);">ğŸ“¸ ê¸°ë³¸ ì •ë³´</div>
          <input name="breed" placeholder="í’ˆì¢… (ì˜ˆ: ë§í‹°ì¦ˆ, í•œêµ­ ê³ ì–‘ì´)" required>
          <input name="image_url" placeholder="ì´ë¯¸ì§€ ì£¼ì†Œ (http://...)" required>

          <div style="display:flex; gap:5px;">
             <input name="gender" placeholder="ì„±ë³„ (ìˆ˜ì»·/ì•”ì»·)" style="flex:1;">
          </div>
          
          <div style="display:flex; gap:5px; margin-top:5px;">
             <input name="weight" placeholder="ì²´ì¤‘ (ì˜ˆ: 5kg)" style="flex:1;">
             <input name="years" placeholder="ë‚˜ì´ (ì˜ˆ: 2023ë…„ìƒ)" style="flex:1;">
          </div>

          <div style="margin:10px 0 5px 0; font-weight:bold; color:var(--accent);">ğŸ“… ê³µê³  ê¸°ê°„</div>
          <div style="display:flex; gap:5px; align-items:center;">
             <span style="font-size:12px;">ì‹œì‘ì¼</span>
             <input type="date" name="register_date" required style="flex:1;">
          </div>
          <div style="display:flex; gap:5px; align-items:center;">
             <span style="font-size:12px;">ì¢…ë£Œì¼</span>
             <input type="date" name="register_end_date" required style="flex:1;">
          </div>

          <div style="margin:10px 0 5px 0; font-weight:bold; color:var(--accent);">ğŸ  ë³´í˜¸ ì¥ì†Œ</div>
          <input name="region" placeholder="ë°œê²¬ ì§€ì—­ (ì˜ˆ: ìˆ˜ì›ì‹œ)">
          <input name="shelter_name" placeholder="ë³´í˜¸ì†Œ ì´ë¦„">
          
          <button class="btn primary full" type="submit" style="margin-top:10px;">ë™ë¬¼ ë“±ë¡í•˜ê¸°</button>
        </form>

        <div class="data-list">
          {% for item in animals %}
          <div class="data-item">
            <div>
               <strong>{{ item['breed'] }}</strong> ({{ item['region'] }})<br>
               <span style="color:#888; font-size:12px;">{{ item['register_date'] }}</span>
            </div>
            <form action="/admin/delete/animal/{{ item['animal_id'] }}" method="POST" onsubmit="return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?');">
               <button class="del-btn">ì‚­ì œ</button>
            </form>
          </div>
          {% endfor %}
        </div>
      </section>

      <section class="admin-section">
        <div class="admin-header"><h3>ğŸ  ë³´í˜¸ì†Œ ê´€ë¦¬</h3></div>
        
        <form class="add-form" action="/admin/add" method="POST">
          <input type="hidden" name="item_type" value="shelter">
          <input name="name" placeholder="ë³´í˜¸ì†Œ ì´ë¦„" required>
          <input name="phone" placeholder="ì „í™”ë²ˆí˜¸">
          <input name="address" placeholder="ì£¼ì†Œ">
          <button class="btn primary full" type="submit">ë³´í˜¸ì†Œ ì¶”ê°€</button>
        </form>

        <div class="data-list">
          {% for item in shelters %}
          <div class="data-item">
            <div><strong>{{ item['name'] }}</strong><br><span style="color:#888">{{ item['phone'] }}</span></div>
            <form action="/admin/delete/shelter/{{ item['shelter_id'] }}" method="POST" onsubmit="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
               <button class="del-btn">ì‚­ì œ</button>
            </form>
          </div>
          {% endfor %}
        </div>
      </section>

      <section class="admin-section">
        <div class="admin-header"><h3>ğŸ¥ ë³‘ì› ê´€ë¦¬</h3></div>
        
        <form class="add-form" action="/admin/add" method="POST">
          <input type="hidden" name="item_type" value="hospital">
          <input name="name" placeholder="ë³‘ì› ì´ë¦„" required>
          <input name="phone" placeholder="ì „í™”ë²ˆí˜¸">
          <input name="address" placeholder="ì£¼ì†Œ">
          <button class="btn primary full" type="submit">ë³‘ì› ì¶”ê°€</button>
        </form>

        <div class="data-list">
          {% for item in hospitals %}
          <div class="data-item">
            <div><strong>{{ item['name'] }}</strong><br><span style="color:#888">{{ item['address'] }}</span></div>
            <form action="/admin/delete/hospital/{{ item['hospital_id'] }}" method="POST" onsubmit="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
               <button class="del-btn">ì‚­ì œ</button>
            </form>
          </div>
          {% endfor %}
        </div>
      </section>

    </div>
  </main>
</body>
</html>