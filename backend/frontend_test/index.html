<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PetMatch</title>
  <link rel="stylesheet" href="{{ url_for('serve_css') }}" />
</head>
<body>
  <header class="topbar">
    <div class="brand"><a href="/" style="text-decoration:none; color:inherit;">ğŸ¾ PetMatch</a></div>
    <nav class="nav">
      <a href="/animals">ìœ ê¸°ë™ë¬¼</a>
      <a href="/shelter">ë³´í˜¸ì†Œ</a>
      <a href="/hospital">ë³‘ì›/ì•½êµ­</a>
      <a class="btn ghost" href="/login">ë¡œê·¸ì¸</a>
    </nav>
  </header>

  <main class="container">
    <section class="hero">
      <h1>ê°€ì¡±ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¹œêµ¬ë“¤ì„ ì°¾ì•„ìš”</h1>
      <p>ì§€ì—­/í’ˆì¢…/ì„±ë³„ë¡œ ë¹ ë¥´ê²Œ ê²€ìƒ‰í•˜ê³  ë³´í˜¸ì†Œ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
      
      <div class="searchbar">
        <input id="homeSearchInput" placeholder="í’ˆì¢…, ì§€ì—­, í‚¤ì›Œë“œë¡œ ê²€ìƒ‰" onkeypress="handleEnter(event)"/>
        <button class="btn primary" onclick="goSearch()">ê²€ìƒ‰</button>
      </div>
      
      <div class="chips">
        <button class="chip" onclick="goFilter('species', 'ê°œ')">ê°•ì•„ì§€</button>
        <button class="chip" onclick="goFilter('species', 'ê³ ì–‘ì´')">ê³ ì–‘ì´</button>
        <button class="chip" onclick="goFilter('gender', 'ìˆ˜ì»·')">ìˆ˜ì»·</button>
        <button class="chip" onclick="goFilter('gender', 'ì•”ì»·')">ì•”ì»·</button>
      </div>
    </section>

    <section class="results">
      <div class="results-head">
        <h2>ìµœì‹  ë“±ë¡ëœ ì¹œêµ¬ë“¤ ğŸ¾</h2>
        <a href="/animals" class="btn ghost">ë”ë³´ê¸°</a>
      </div>

      <div class="grid">
        {% if latest_animals %}
          {% for animal in latest_animals %}
          <article class="card">
            <div class="thumb" style="background-color: #eee; display:flex; align-items:center; justify-content:center; overflow:hidden;">
              {% if animal['image_url'] %}
                <img src="{{ animal['image_url'] }}" alt="{{ animal['breed'] }}" style="width:100%; height:100%; object-fit:cover;">
              {% else %}
                <span style="font-size:30px;">ğŸ¶</span>
              {% endif %}
            </div>
            <div class="card-body">
              <div class="title">{{ animal['breed'] }}</div>
              <div class="meta">{{ animal['gender'] }} Â· {{ animal['weight'] }}</div>
              <div class="meta">ì§€ì—­: {{ animal['region'] }}</div>
              <div class="meta">ê³µê³ : {{ animal['register_date'] }}</div>
              <div class="meta">ë³´í˜¸ì†Œ: {{ animal['shelter_name'] }}</div>
              <div class="actions">
                <a class="btn primary" href="/animals?keyword={{ animal['breed'] }}">ë³´ëŸ¬ê°€ê¸°</a>
                <button class="btn ghost">â™¡</button>
              </div>
            </div>
          </article>
          {% endfor %}
        {% else %}
          <p style="padding:20px;">ìµœì‹  ë“±ë¡ëœ ìœ ê¸°ë™ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
      </div>
    </section>
  </main>

  <script>
    // ê²€ìƒ‰ ì‹¤í–‰ í•¨ìˆ˜
    function goSearch() {
        const keyword = document.getElementById('homeSearchInput').value;
        if (keyword) {
            // ë™ë¬¼ ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™í•˜ë©´ì„œ ê²€ìƒ‰ì–´ ì „ë‹¬
            window.location.href = `/animals?keyword=${encodeURIComponent(keyword)}`;
        } else {
            alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
        }
    }

    // ì¹© ë²„íŠ¼ í´ë¦­ ì‹œ í•„í„° ì ìš© ì´ë™
    function goFilter(key, value) {
        window.location.href = `/animals?${key}=${encodeURIComponent(value)}`;
    }

    // ì—”í„°í‚¤ ì²˜ë¦¬
    function handleEnter(e) {
        if(e.key === 'Enter') goSearch();
    }
  </script>
</body>
</html>